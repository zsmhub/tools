<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>团建活动通知</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

    <!-- 预加载字体 -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700&display=swap" rel="stylesheet">

    <!-- 配置Tailwind自定义样式 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#FF6B9D',
                        secondary: '#79C1FF',
                        accent: '#FFD166',
                        dark: '#3A4750',
                        light: '#F8F9FA'
                    },
                    fontFamily: {
                        cute: ['"Noto Sans SC"', 'sans-serif'],
                    },
                }
            }
        }
    </script>

    <style>
        /* 确保字体一致性 */
        body {
            font-family: 'Noto Sans SC', sans-serif;
            font-size: 15px;
        }

        .font-cute {
            font-family: 'Noto Sans SC', sans-serif !important;
        }

        /* 修复文本换行问题 */
        .text-nowrap {
            white-space: nowrap;
        }

        /* 确保FontAwesome图标正确显示 */
        .fa {
            font-family: 'FontAwesome' !important;
            display: inline-block;
        }

        /* 确保装饰图标在导出时可见 */
        .icon-container {
            position: absolute;
            z-index: 10;
        }

        /* 全局字体大小调整 */
        h1 {
            font-size: 2.2rem !important;
        }

        h2 {
            font-size: 1.7rem !important;
        }

        h3 {
            font-size: 1.05rem !important;
        }

        p, .text-sm {
            font-size: 0.95rem !important;
            line-height: 1.4 !important;
        }

        .fa {
            font-size: 1.1em;
        }
    </style>

    <style type="text/tailwindcss">
        @layer utilities {
            .text-shadow {
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
            }
            .float-animation {
                animation: float 6s ease-in-out infinite;
            }
            .bounce-in {
                animation: bounceIn 0.8s ease-out forwards;
            }
            .slide-up {
                animation: slideUp 0.8s ease-out forwards;
            }
            .scale-in {
                animation: scaleIn 0.5s ease-out forwards;
            }
            .twinkle {
                animation: twinkle 2s ease-in-out infinite;
            }
            .rotate-animation {
                animation: rotate 10s linear infinite;
            }
            .pulse-animation {
                animation: pulse 2s ease-in-out infinite;
            }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        @keyframes bounceIn {
            0% { transform: scale(0.5); opacity: 0; }
            80% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }

        @keyframes slideUp {
            0% { transform: translateY(50px); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }

        @keyframes scaleIn {
            0% { transform: scale(0); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        @keyframes twinkle {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-light to-secondary/20 min-h-screen flex items-center justify-center p-4">
    <!-- 海报容器 - 9:16比例 -->
    <div id="poster-container" class="w-full max-w-md aspect-[9/16] bg-white rounded-3xl overflow-hidden shadow-2xl relative">
        <!-- 背景装饰元素 -->
        <div class="absolute inset-0 overflow-hidden">
            <!-- 彩色圆点背景 -->
            <div class="absolute w-full h-full" style="z-index: 0;">
                <div class="absolute top-1/4 left-1/12 w-24 h-24 rounded-full bg-primary/20 float-animation" style="animation-delay: 0s;"></div>
                <div class="absolute top-2/3 left-3/4 w-32 h-32 rounded-full bg-secondary/20 float-animation" style="animation-delay: 2s;"></div>
                <div class="absolute bottom-1/3 right-1/5 w-16 h-16 rounded-full bg-accent/20 float-animation" style="animation-delay: 4s;"></div>
                <div class="absolute top-1/2 right-1/4 w-20 h-20 rounded-full bg-primary/15 rotate-animation"></div>
                <div class="absolute bottom-1/4 left-1/4 w-28 h-28 rounded-full bg-secondary/15 rotate-animation" style="animation-direction: reverse;"></div>
            </div>
        </div>

        <!-- 海报内容 -->
        <div class="relative z-10 p-5 md:p-6">
            <!-- 标题区域 -->
            <div class="text-center mb-4 slide-up" style="animation-delay: 0.2s;">
                <h1 class="text-[clamp(1.8rem,5vw,2.8rem)] font-cute font-bold text-primary mb-2 text-shadow">
                    团建活动通知
                </h1>
                <div class="w-28 h-1.5 bg-gradient-to-r from-primary via-accent to-secondary mx-auto rounded-full pulse-animation"></div>
            </div>

            <!-- 装饰元素 -->
            <div class="absolute -top-10 -right-10 w-20 h-20 bg-accent/30 rounded-full float-animation" style="animation-delay: 1s;"></div>
            <div class="absolute -bottom-10 -left-10 w-28 h-28 bg-primary/30 rounded-full float-animation" style="animation-delay: 3s;"></div>

            <!-- 活动安排卡片 -->
            <div class="bg-white/80 backdrop-blur-sm rounded-2xl p-4 md:p-5 shadow-lg mb-3 scale-in" style="animation-delay: 0.4s;">
                <h2 class="text-[clamp(1.3rem,3vw,1.8rem)] font-cute font-bold text-dark mb-3 flex items-center">
                    <i class="fa fa-list-alt mr-3 text-primary"></i>活动安排
                </h2>

                <div class="space-y-3">
                    <!-- 时间 -->
                    <div class="flex items-start p-3 bg-light rounded-xl border-2 border-primary/30 hover:border-primary/60 transition-all duration-300">
                        <div class="w-9 h-9 rounded-full bg-primary text-white flex items-center justify-center font-bold mr-3 flex-shrink-0 text-base">1</div>
                        <div>
                            <h3 class="font-cute font-semibold text-dark mb-1 text-nowrap">团建时间</h3>
                            <p class="text-dark/80 text-nowrap">7月19日，周六，下午14:30~22:00</p>
                        </div>
                    </div>

                    <!-- 地点 -->
                    <div class="flex items-start p-3 bg-light rounded-xl border-2 border-secondary/30 hover:border-secondary/60 transition-all duration-300">
                        <div class="w-9 h-9 rounded-full bg-secondary text-white flex items-center justify-center font-bold mr-3 flex-shrink-0 text-base">2</div>
                        <div>
                            <h3 class="font-cute font-semibold text-dark mb-1 text-nowrap">团建地点</h3>
                            <p class="text-dark/80">椿风小院，番禺区大龙街亚运大道573号123</p>
                        </div>
                    </div>

                    <!-- 参与人员 -->
                    <div class="flex items-start p-3 bg-light rounded-xl border-2 border-accent/30 hover:border-accent/60 transition-all duration-300">
                        <div class="w-9 h-9 rounded-full bg-accent text-white flex items-center justify-center font-bold mr-3 flex-shrink-0 text-base">3</div>
                        <div>
                            <h3 class="font-cute font-semibold text-dark mb-1 text-nowrap">参与人员</h3>
                            <p class="text-dark/80 text-nowrap">公司全体员工</p>
                        </div>
                    </div>

                    <!-- 活动内容 -->
                    <div class="flex items-start p-3 bg-light rounded-xl border-2 border-primary/30 hover:border-primary/60 transition-all duration-300">
                        <div class="w-9 h-9 rounded-full bg-primary text-white flex items-center justify-center font-bold mr-3 flex-shrink-0 text-base">4</div>
                        <div>
                            <h3 class="font-cute font-semibold text-dark mb-1 text-nowrap">活动内容</h3>
                            <p class="text-dark/80">烧烤、团队互动游戏、麻将、唱K等</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 温馨提示卡片 -->
            <div class="bg-white/80 backdrop-blur-sm rounded-2xl p-4 md:p-5 shadow-lg scale-in" style="animation-delay: 0.6s;">
                <h2 class="text-[clamp(1.3rem,3vw,1.8rem)] font-cute font-bold text-dark mb-3 flex items-center">
                    <i class="fa fa-lightbulb-o mr-3 text-accent"></i>温馨提示
                </h2>

                <div class="space-y-3">
                    <div class="flex items-start">
                        <div class="w-8 h-8 rounded-full bg-primary/20 text-primary flex items-center justify-center mr-3 mt-1 flex-shrink-0">
                            <i class="fa fa-info"></i>
                        </div>
                        <div>
                            <p class="text-dark/90">
                                <span class="font-cute font-semibold">1.</span>
                                <span class="text-nowrap">个人需要准备手机充电器/充电宝、蚊怕水</span>
                            </p>
                        </div>
                    </div>

                    <div class="flex items-start">
                        <div class="w-8 h-8 rounded-full bg-primary/20 text-primary flex items-center justify-center mr-3 mt-1 flex-shrink-0">
                            <i class="fa fa-info"></i>
                        </div>
                        <div>
                            <p class="text-dark/90">
                                <span class="font-cute font-semibold">2.</span>
                                <span class="text-nowrap">尽量穿着舒适、宽松、透气的衣服和鞋子</span>
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 装饰元素 - 可爱图标 -->
            <!-- <div class="icon-container bottom-6 left-6 w-12 h-12">
                <div class="w-full h-full bg-accent/40 rounded-full flex items-center justify-center">
                    <i class="fa fa-cutlery text-white text-xl"></i>
                </div>
            </div>
            <div class="icon-container bottom-8 right-6 w-14 h-14">
                <div class="w-full h-full bg-primary/40 rounded-full flex items-center justify-center">
                    <i class="fa fa-gamepad text-white text-xl"></i>
                </div>
            </div> -->

            <!-- 底部装饰 -->
            <div class="absolute bottom-0 left-0 w-full h-12 bg-gradient-to-t from-primary/20 to-transparent rounded-t-3xl"></div>
        </div>
    </div>

    <!-- 控制按钮 -->
    <!-- <div class="mt-6 flex justify-center gap-4">
        <button id="download-btn" class="px-6 py-3 bg-primary text-white rounded-full shadow-lg hover:bg-primary/80 transition-all duration-300 flex items-center">
            <i class="fa fa-download mr-2"></i> 下载海报
        </button>
    </div> -->

    <script>
        // 下载海报功能
        function downloadPoster() {
            // 禁用下载按钮防止重复点击
            const downloadBtn = document.getElementById('download-btn');
            downloadBtn.disabled = true;
            downloadBtn.innerHTML = '<i class="fa fa-spinner fa-spin mr-2"></i> 生成中...';

            // 隐藏控制按钮，避免被截取到海报中
            document.querySelector('.mt-6').style.display = 'none';

            // 创建一个临时的样式元素，确保字体在导出时正确应用
            const styleEl = document.createElement('style');
            styleEl.textContent = `
                #poster-container * {
                    font-family: 'Noto Sans SC', sans-serif !important;
                }
                #poster-container .font-cute {
                    font-family: 'Noto Sans SC', sans-serif !important;
                }
                #poster-container p, #poster-container h1, #poster-container h2, #poster-container h3 {
                    white-space: nowrap !important;
                    word-break: keep-all !important;
                    overflow: visible !important;
                }
                #poster-container .fa {
                    font-family: 'FontAwesome' !important;
                    display: inline-block !important;
                }
                #poster-container h1 {
                    font-size: 2.2rem !important;
                }
                #poster-container h2 {
                    font-size: 1.7rem !important;
                }
                #poster-container h3 {
                    font-size: 1.05rem !important;
                }
                #poster-container p {
                    font-size: 0.95rem !important;
                    line-height: 1.4 !important;
                }
                #poster-container .text-sm {
                    font-size: 0.95rem !important;
                }
            `;
            document.head.appendChild(styleEl);

            // 确保字体已完全加载
            setTimeout(() => {
                // 使用html2canvas捕获海报区域
                html2canvas(document.getElementById('poster-container'), {
                    scale: 3, // 提高分辨率
                    useCORS: true, // 允许跨域图片
                    logging: false,
                    backgroundColor: 'white', // 使用白色背景
                    allowTaint: true, // 允许跨域元素
                    letterRendering: true, // 提高文字渲染质量
                    foreignObjectRendering: false, // 禁用foreignObject渲染以提高兼容性
                    removeContainer: false, // 不移除容器
                    onclone: (clonedDoc) => {
                        // 在克隆的文档中强制应用样式
                        const clonedContainer = clonedDoc.getElementById('poster-container');
                        if (clonedContainer) {
                            // 确保所有元素都应用正确的样式
                            const allElements = clonedContainer.querySelectorAll('*');
                            allElements.forEach(el => {
                                if (el.textContent && el.textContent.trim()) {
                                    el.style.fontFamily = "'Noto Sans SC', sans-serif";
                                    el.style.wordBreak = 'keep-all';
                                    el.style.whiteSpace = 'nowrap';
                                    el.style.overflow = 'visible';
                                }

                                // 确保图标正确显示
                                if (el.classList.contains('fa')) {
                                    el.style.fontFamily = 'FontAwesome';
                                    el.style.display = 'inline-block';
                                }
                            });

                            // 确保装饰图标可见
                            const icons = clonedContainer.querySelectorAll('.fa-cutlery, .fa-gamepad');
                            icons.forEach(icon => {
                                const parent = icon.closest('.absolute');
                                if (parent) {
                                    parent.style.opacity = '1';
                                    parent.style.visibility = 'visible';
                                }
                            });
                        }
                    }
                }).then(canvas => {
                    // 创建下载链接
                    const link = document.createElement('a');
                    link.download = '团建活动海报.png';
                    link.href = canvas.toDataURL('image/png');
                    link.click();

                    // 恢复按钮状态和显示控制按钮
                    downloadBtn.disabled = false;
                    downloadBtn.innerHTML = '<i class="fa fa-download mr-2"></i> 下载海报';
                    document.querySelector('.mt-6').style.display = 'flex';

                    // 移除临时样式
                    document.head.removeChild(styleEl);
                }).catch(error => {
                    console.error('生成海报失败:', error);
                    alert('下载失败，请重试');

                    // 恢复按钮状态和显示控制按钮
                    downloadBtn.disabled = false;
                    downloadBtn.innerHTML = '<i class="fa fa-download mr-2"></i> 下载海报';
                    document.querySelector('.mt-6').style.display = 'flex';

                    // 移除临时样式
                    document.head.removeChild(styleEl);
                });
            }, 800); // 给予800毫秒确保字体和图标加载
        }

        // 按钮点击事件 - 下载海报
        document.getElementById('download-btn').addEventListener('click', downloadPoster);

        // 页面加载动画
        document.addEventListener('DOMContentLoaded', function() {
            // 添加闪烁星星效果
            for (let i = 0; i < 15; i++) {
                const star = document.createElement('div');
                star.className = 'twinkle absolute';
                star.style.width = Math.random() * 4 + 1 + 'px';
                star.style.height = star.style.width;
                star.style.backgroundColor = i % 3 === 0 ? '#FFD166' : (i % 3 === 1 ? '#FF6B9D' : '#79C1FF');
                star.style.borderRadius = '50%';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 2 + 's';
                document.querySelector('.absolute.inset-0.overflow-hidden').appendChild(star);
            }
        });
    </script>
</body>
</html>